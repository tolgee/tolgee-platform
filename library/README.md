# Tolgee UI Library

This project is a library of components/hooks/... which are reused across other
Tolgee applications. This is not an application by itself, but there is a
Storybook instance integrated to display and let you try the components
individually or in preset combinations.

## Storybook

[Storybook](https://storybook.js.org/) is a catalog of components. This
particular instance hosts those of the Tolgee library.

### Setup Storybook

One time Storybook setup.

Install dependencies of Storybook and the library itself:

```shell
cd library
npm ci
```

Duplicate [.env](./.env) as [.env.local](./.env.local) and configure your
Tolgee API KEY.

Addon for Tolgee is preset, but its dependencies have to be also installed and
the addon built to work properly:

```shell
cd storybook-tolgee-addon
npm ci
npm run build
```

### Open Storybook

Every time you want to open Storybook run:

```shell
cd library
npm run storybook
```

Storybook should open in your browser, otherwise open <http://localhost:6006/>.

## Component Migration

- Apply the boy scout rule – improve names, aliases, subpaths, dependencies...
- Move the component/hook/... from `webapp/src/component/` directory under `library/src/components/` (note the plural – we are unifying it to plurals everywhere). If the component/hook/... is placed under a subpath, persist it.
- Keep one component per file. Constants reused elsewhere can be placed under `constants.ts`. Helper functions under `utils.ts`.
- Up until now, each component was a single file (e.g. `MfaBadge.tsx`), this is changing (not for hooks/...). Please create a directory named like the component (i.e. `MfaBadge`), move the component inside and name it `index.tsx`. This way the component can still be referenced the same path (omit `index.tsx` in the path).
- Remove the original component/hook/...
- Update dependencies. Within `webapp` and `library` use `@tginternal/library/` prefix (e.g. `@tginternal/library/hooks/useCurrentLanguage`). Referencing `webapp` from `library` might not be safe. At the moment, only a few prefixes are predefined in `library`'s [tsconfig.json](./tsconfig.json), [package.json](./package.json) and [vite.config.ts](./vite.config.ts), add more as you need them.
- Remember the boy scout rule.

## Component Documentation

- Read [writing stories](https://storybook.js.org/docs/writing-stories) Storybook docs.
- CSF docs:
  - In the component directory, create `stories.ts` file.
  - The component (object of `Meta` type) and its stories (objects of `Story` type) are declared and exported here.
  - Many properties can be set here, but Storybook can derive a lot by itself, so check the defaults at first. Storybook inspects the component's code for prop names, comments... so rather spend time on the component than on the stories (TSDoc comments will bring the value also elsewhere).
  - Many properties can be set on the component level for all stories or on the individual story level.
  - For inspiration have a look on [MfaBadge/stories.ts](./src/components/MfaBadge/stories.ts).
  - For details have a look on [CSF docs](https://storybook.js.org/docs/api/csf).
- MDX docs:
  - If the autogenerated CSF documentation is not enough (e.g. additional formatted texts are needed), create `stories.mdx` file next to `stories.ts`.
  - You have a free hand in writing arbitrary Markdown texts here and inserting stories from `stories.ts` to them. Please follow CSF structure and other MDX files.
  - For inspiration have a look on [FlagImage/stories.mdx](./src/components/languages/FlagImage/stories.mdx).
  - For details have a look on [MDX docs](https://storybook.js.org/docs/writing-docs/mdx).
